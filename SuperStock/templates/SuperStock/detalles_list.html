{% extends 'SuperStock/base.html' %}

{% block content %}
    <div>
        <ul class="nav nav-tabs">
            <li class="nav-item">
              <a class="nav-link active bg-success" aria-current="page" href="{% url 'detalles_list' %}">Lista</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'detalles_new' %}">Agregar</a>
            </li>
        </ul>                
        <h3>Lista de Detalles de Ventas</h3>
        <form method="post" action="{% url 'detalles_list' %}">
          {% csrf_token %}
            <div style="display: flex; justify-content: space-between; margin-right: 5%;">

              <div>
                <label for="id_detalles_venta">ID</label><br>
                <input type="number" id="id_detalles_venta" name="id_detalles_venta" value="" placeholder="Buscar...">
              </div>

              <div>
                <label for="id_ventas">ID de Ventas</label><br>
                <input type="number" id="id_ventas" name="id_ventas" value="" placeholder="Buscar...">
              </div>

              <div>
                <label for="fecha">Fecha</label><br>
                <input type="date" id="fecha" name="fecha" value="">
              </div>

              <div>
                <label for="in_active">Activo?</label><br>
                <label for="si">si</label>
                <input type="checkbox" id="si" name="in_active" value="si"><br>
                <label for="no">no</label>
                <input type="checkbox" id="no" name="in_active" value="no">
              </div>

              <div>
                <input type="submit" value="Aplicar filtros" class="buttonUwu"><br>
                <button type="button" class="buttonUwu" style="margin-top: 10px;"><a href="{% url 'detalles_list' %}">Resetear</a></button>
              </div>

            </div>
        </form>
        <table class="table">
          <thead>
            <tr>
              <th scope="col">ID</th>
              <th scope="col">ID Ventas</th>
              <th scope="col">Productos</th>
              <th scope="col">Cantidad</th>
              <th scope="col">Fecha y Hora</th>
              <th scope="col">Estado</th>
              <th scope="col">Acciones</th>
            </tr>
          </thead>
                {% for detalle in detalles %}
                  <tbody>
                    <tr>
                      <td scope="row"><a href="{% url 'detalles_detail' pk=detalle.id_detalles_venta %}">{{ detalle.id_detalles_venta }}</a></td>
                      <td>{{ detalle.id_ventas }}</td>
                      <td>
                        {% for producto in detalle.id_productos.all %}
                          <ul>
                            <li><span>{{ producto.nombreP }}</span></li>
                          </ul>
                        {% empty %}
                          <span>No hay productos seleccionados</span>
                        {% endfor %}
                      </td>
                      <td>
                          {{ cantidades|length }}
                          {{ detalle.cantidad }}
                      </td>
                      <td>{{ detalle.fecha_creacion|date:"d-m-Y" }}</td>
                      <td>{% if detalle.in_active == True %}activo{% else %}inactivo{% endif %}</td>
                      <td><button type="button" class="buttonUwu"><a href="{% url 'detalles_edit' pk=detalle.id_detalles_venta %}">Edit</a></button>
                          {% if detalle.in_active == True %}<button type="button" class="buttonUwuu"><a href="{% url 'detalles_delete' pk=detalle.id_detalles_venta %}">Borrar</a></button>{% else %}
                          <button type="button" class="buttonUwuuu"><a href="{% url 'detalles_restore' pk=detalle.id_detalles_venta %}">Restaurar</a></button>{% endif %}
                      </td>
                    </tr>
                  </tbody>
                {% endfor %}
        </table>
    </div>
{% endblock %}

